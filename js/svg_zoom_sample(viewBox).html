<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SVG viewBox ズームサンプル</title>
  <style>
    body { margin: 0; background: #0f172a; color: #f1f5f9; font-family: sans-serif; }
    header { padding: 12px; background: rgba(255,255,255,0.05); display: flex; gap: 8px; align-items: center; }
    button, input[type=range] { margin: 0 4px; }
    svg { width: 100%; height: 90vh; display: block; background: #111827; }
  </style>
</head>
<body>
<header>
  <button id="fit">全体表示</button>
  <button id="zin">＋ 拡大</button>
  <button id="zout">－ 縮小</button>
  <label>倍率 <span id="scaleLabel">100%</span></label>
  <input id="zoom" type="range" min="0.25" max="4" value="1" step="0.01">
</header>

<svg id="stage" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
  <g id="scene">
    <defs>
      <linearGradient id="grad" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#38bdf8" />
        <stop offset="100%" stop-color="#9333ea" />
      </linearGradient>
    </defs>

    <rect x="0" y="0" width="800" height="500" fill="url(#grad)" opacity="0.4"/>
    <circle cx="200" cy="200" r="100" fill="#facc15"/>
    <circle cx="600" cy="300" r="150" fill="#22c55e" opacity="0.7"/>
    <polygon points="400,50 450,150 550,150 470,220 500,320 400,260 300,320 330,220 250,150 350,150"
             fill="#e11d48" stroke="#fff" stroke-width="3"/>
    <text x="400" y="480" text-anchor="middle" fill="#f8fafc" font-size="32">viewBox Zoom Sample</text>
  </g>
</svg>

<script>
  const svg = document.getElementById('stage');
  const scene = document.getElementById('scene');
  const zoom = document.getElementById('zoom');
  const zin = document.getElementById('zin');
  const zout = document.getElementById('zout');
  const fit = document.getElementById('fit');
  const label = document.getElementById('scaleLabel');

  const baseBox = scene.getBBox();
  let scale = 1;

  function applyViewBox() {
    const w = baseBox.width / scale;
    const h = baseBox.height / scale;
    const cx = baseBox.x + baseBox.width / 2;
    const cy = baseBox.y + baseBox.height / 2;
    svg.setAttribute('viewBox', `${cx - w/2} ${cy - h/2} ${w} ${h}`);
    label.textContent = Math.round(scale * 100) + '%';
  }

  zoom.addEventListener('input', e => {
    scale = Number(e.target.value);
    applyViewBox();
  });

  zin.addEventListener('click', () => {
    scale = Math.min(4, scale * 1.2);
    zoom.value = scale;
    applyViewBox();
  });
  zout.addEventListener('click', () => {
    scale = Math.max(0.25, scale / 1.2);
    zoom.value = scale;
    applyViewBox();
  });
  fit.addEventListener('click', () => {
    scale = 1;
    zoom.value = scale;
    applyViewBox();
  });

  applyViewBox();
</script>
</body>
</html>