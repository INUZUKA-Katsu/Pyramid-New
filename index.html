<!DOCTYPE html>
<html lang="ja">
  <html manifest="/cache.manifest">
    <head>
      <title id="title">横浜市の人口ピラミッド（市、区別、町丁別）</title>
      <meta charset="utf-8" />
      <meta
        name="description"
        content="横浜市がWebサイトで公表している人口統計を利用して作成できる全ての人口ピラミッドを自由自在に表示できる。あらゆる年、区、複数の町丁目を含む小地域の人口ピラミッド。将来推計人口による将来予測も。横浜市の公表するオープンデータをリアルタイムで取得するので、公表されたばかりの人口統計をタイムラグなしにすぐに人口ピラミッドで見ることができる。"
      />
      <meta
        name="key words"
        content="オープンデータ,人口ピラミッド,将来推計人口,横浜市,町・丁目,小地域"
      />
      <meta name="author" content="INUZUKA Katsu" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link
        rel="stylesheet"
        href="./js/jquery-ui-1.12.1/jquery-ui.min.css"
        type="text/css"
      />
      <link
        rel="stylesheet"
        href="./js/tooltip/darktooltip.css"
        type="text/css"
      />
      <script type="text/javascript" src="./js/pyramid.js"></script>
      <script type="text/javascript" src="./js/PyramidSVGRenderer.js"></script>
      <script type="text/javascript" src="./js/jquery-3.1.1.js"></script>
      <script
        type="text/javascript"
        src="./js/jquery-ui-1.12.1/jquery-ui.min.js"
      ></script>
      <script
        type="text/javascript"
        src="./js/tooltip/jquery.darktooltip.js"
      ></script>
      <script type="text/javascript" src="/js/html2canvas.js"></script>
      <!--script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script> -->
      <script type="text/javascript">
        //  http://rubentd.com/darktooltip/
        var w;
        $(function () {
          w = $(window).width();
          tooltip_set();
        });
        $(window).resize(function () {
          w = $(window).width();
          tooltip_reset();
          tooltip_set();
        });
        function tooltip_set() {
          $("#screen_shot_tooltip").darkTooltip({
            animation: "none",
            size: "small",
            gravity: "north",
            theme: "light",
            trigger: "click",
            container: "body", // この行を追加
          });
          $(".header").darkTooltip({
            animation: "none",
            size: "small",
            gravity: "north",
            theme: "light",
            trigger: "click",
          });
          $(".info-icon-left").darkTooltip({
            animation: "none",
            size: "small",
            gravity: device("bottom", "bottom"),
            theme: "light",
            trigger: "click",
          });
          $(".info-icon-right").darkTooltip({
            animation: "none",
            size: "small",
            gravity: device("bottom", "left"),
            theme: "light",
            trigger: "click",
          });
          $(".info-icon-bottom").darkTooltip({
            animation: "none",
            size: "small",
            gravity: device("top", "left"),
            theme: "light",
            trigger: "click",
          });
          $(".info-icon-3kubun").darkTooltip({
            animation: "none",
            size: "small",
            gravity: device("top", "left"),
            theme: "light",
            trigger: "click",
          });
        }
        function tooltip_reset() {
          $("ins").remove();
        }
        function device(pc, mobile) {
          if (w > 1800) {
            return direction(pc);
          } else {
            return direction(mobile);
          }
        }
        function direction(nsew) {
          if (nsew == "top") {
            return "south";
          } else if (nsew == "bottom") {
            return "north";
          } else if (nsew == "left") {
            return "east";
          } else {
            return "west";
          }
        }
      </script>
      <!--link type="text/css" href="./css/pyramid.css" rel="stylesheet"-->
      <style type="text/css">
        /*.controls {
          display: flex;
          flex-wrap: wrap;
          gap: 15px;
          margin-bottom: 30px;
          padding: 20px;
          background: #f8f9fa;
          border-radius: 5px;
        }*/

        h1,
        h2 {
          margin-left: 250px;
        }
        /* 親コンテナをflexで横並びにする */
        #container-flex {
          display: flex;
          align-items: flex-start;
          /*display: grid;
          grid-template-columns: 1fr 1fr;*/
          justify-content: center;
          /*width: 100%;*/
          /*height: 100vh;*/
          gap: 20px;
          padding: 10px;
        }
        #pyramid-block {
          /*position: absolute;
          left: 250px;
          top: 160px;*/
          display: flex;
          flex-direction: column;
          width: 1108px;
          /*text-align: left;*/
          margin-left: 260px;
          margin-bottom: 20px;
        }
        #pyramid-container {
          text-align: left;
          #pyramid-container {
            width: 1108px;
            max-width: 100%;
            overflow: hidden;
            position: relative;
          }
          /*border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            min-height: 600px;
            margin-left: 20px;
            margin-right: auto;
            margin-bottom: 20px;
            overflow: auto;*/
        }

        /* 左端に縦に並ぶコントロール用のスタイル */
        .left-controls {
          /*position: fixed;
          right: 20px;
          top: 50%;
          transform: translateY(-50%);
          max-width: 250px;*/
          position: absolute;
          left: 5px;
          top: 160px;
          width: 250px;
          /*display: flex;
          flex-direction: column;*/
          gap: 10px;
          background: rgba(248, 249, 250, 0.95);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          /*  padding: 20px;
            border-radius: 10px;
            border: 1px solid #dee2e6;*/
        }

        .left-controls .control-group {
          background: white;
          padding: 15px;
          border-radius: 8px;
          border: 1px solid #dee2e6;
        }

        .left-controls .control-group h3 {
          margin: 0 0 10px 0;
          color: #495057;
          font-size: 1em;
          border-bottom: 2px solid #007bff;
          padding-bottom: 5px;
        }

        .left-controls .button-group {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .left-controls .button-group button {
          width: 100%;
          padding: 8px 12px;
          font-size: 12px;
        }

        .left-controls .radio-group {
          display: flex;
          flex-direction: row;
          gap: 8px;
          margin-top: 10px;
          justify-content: center;
        }

        .left-controls .radio-group label {
          font-size: 12px;
        }

        .control-group {
          display: flex;
          flex-direction: column;
          gap: 5px;
        }

        .control-group label {
          font-weight: bold;
          color: #555;
        }

        .control-group select,
        .control-group input,
        .control-group button {
          padding: 8px 12px;
          border: 1px solid #ddd;
          border-radius: 4px;
          background: white;
        }

        .control-group button {
          background: #007bff;
          color: white;
          cursor: pointer;
          border: none;
        }

        .control-group button:hover {
          background: #0056b3;
        }

        .control-group button.active {
          background: #28a745;
        }

        #cho {
          z-index: 1;
        }

        #source_container {
          margin-bottom: 10px;
        }

        #footer {
          margin-top: 30px;
          margin-left: 260px;
          z-index: 1000;
        }

        /* デモデータコントロールを不可視に */
        .demo-controls {
          display: none !important;
        }

        /* 幅が狭い場合（例: 1200px以下）にfixed解除して縦並びに */
        @media (max-width: 1200px) {
          h1,
          h2 {
            margin-left: 0;
          }

          /* 親コンテナを縦並びへ */
          #container-flex {
            flex-direction: column;
            align-items: stretch;
          }
          #pyramid-block {
            position: static !important;
            width: 100% !important;
            left: auto !important;
            top: auto !important;
            margin: 0;
          }
          /*#footer {
            position: static;
          }*/
          /* fixed解除 */
          .left-controls {
            position: static;
            transform: none;
            width: 100%;
            max-width: 100%;
            margin-top: 1em;
            box-shadow: none;
          }
          /* コントロール各グループを横並びに */
          .left-controls {
            display: flex;
            flex-direction: row; /* 横並び */
            gap: 30px;
            align-items: flex-start; /* 上揃え */
            flex-wrap: wrap; /* 画面狭いとき折り返し可能 */
          }
          .left-controls .control-group {
            width: 220px; /* 必要に応じて調整 */
            height: 150px; /* 高さも指定可能 */
            box-sizing: border-box; /* paddingやborderが含まれる計算に */
          }
          /* ラベルを左寄せ・固定幅など調整 */
          .left-controls .control-group label {
            min-width: 80px;
            white-space: nowrap;
          }

          /* 入力やボタンは適宜伸縮 */
          .left-controls .control-group select,
          .left-controls .control-group input,
          .left-controls .control-group button {
            flex: 1 1 auto;
          }
          /* pyramid-block幅は画面幅に合わせる */
          #pyramid-block {
            width: 100%;
            margin-left: 0;
            margin-right: 0;
          }
        }
        div.footer {
          margin-top: 0px;
        }

        @media print {
          div.left {
            border: 1px solid blue;
            background-color: blue;
          }
          div.right {
            border: 1px solid red;
            background-color: red;
          }
          #form0,
          div#link,
          h1,
          div#option {
            display: none !important;
          }
          h2 {
            font-size: 250%;
            margin-top: 5px;
            margin-bottom: 2.5em;
            text-align: center;
          }
          div#male_label,
          div#female_label {
            color: black;
            border: 1px solid black;
          }
        }

        @media screen, print {
          body {
            font-family: "Hiragino Kaku Gothic ProN", "Meiryo", "Helvetica Neue",
              "Helvetica", "Hiragino Sans", "Arial", "Yu Gothic", sans-serif;
          }

          a.header {
            margin: 0 0 0 0.5em;
            text-decoration: none;
            color: #3399ff;
          }
          img {
            vertical-align: -17%;
            width: 1em;
            height: 1.2em;
            margin-right: 0.5em;
          }
          img.small-icon {
            vertical-align: -17%;
            width: 1em;
            height: 1.1em;
          }
          caption {
            text-align: right;
          }
          select,
          input {
            font-size: 11pt;
          }
          button {
            font-size: 11pt;
          }
          h1 {
            font-size: 200%;
            font-weight: normal;
            margin-top: 5px;
            text-align: center;
          }
          h2 {
            font-size: 150%;
            font-weight: normal;
            margin-top: 5px;
            text-align: center;
          }
          h2 span.small {
            font-size: 85%;
            font-weight: 400;
          }
          div#header {
            text-align: right;
            font-size: 80%;
            color: #0099ff;
            width: 100%;
            margin-right: 1em;
          }
          div#main {
            text-align: center;
            /*width:1108px;*/
            margin-left: auto;
            margin-right: auto;
          }
          div#select-controls {
            width: 1108px;
            text-align: right;
            margin-left: auto;
            margin-right: 20px;
            display: inline-block;
            vertical-align: top;
            position: relative;
          }
          div#link {
            /*position:absolute;
                              right:0;
                              top:2.3em;*/
            margin-left: auto;
            width: 22em;
            margin-bottom: 0.5em;
          }
          div#comment {
            position: absolute;
            left: 0;
            top: -20px;
            color: red;
            border: 1px solid red;
            padding: 5px;
          }
          div#hitoku {
            position: absolute;
            left: 10px;
            top: 10px;
            color: #0099ff;
            font-size: 80%;
            width: 30%;
            text-align: left;
            display: block;
          }
          div#male_label {
            position: absolute;
            left: 100px;
            top: 70px;
            color: blue;
            border: 1px solid blue;
            padding: 5px;
          }
          div#female_label {
            position: absolute;
            right: 100px;
            top: 70px;
            color: red;
            padding: 5px;
            border: 1px solid red;
          }
          div#age75 {
            position: absolute;
            left: 20px;
            font-size: 10pt;
          }
          div#age65 {
            position: absolute;
            left: 20px;
            font-size: 10pt;
          }
          div#age15 {
            position: absolute;
            left: 20px;
            font-size: 10pt;
          }
          /*div#age75 span{ vertical-align:20px; }
          div#age65 span{ vertical-align:20px; }
          div#age15 span{ vertical-align:20px; }*/
          table {
            min-width: 1108px;
            table-layout: fixed;
            display: inline-block;
            background-color: #f5f5f5;
            border-collapse: collapse;
            border: none;
            padding: 0;
            margin-top: 0;
            padding: 0;
            line-height: 1;
          }
          td {
            padding: 0;
            margin: 0;
            border: none;
            padding-bottom: 0px;
            white-space: nowrap;
            /*background-color:#f5f5f5; whitesmoke*/
            /*height:5px;*/
            /*line-height: 1;*/
            font-size: 4px;
          }
          tr.line td {
            border-bottom: 1px solid #b0c4de; /*lightsteelblue*/
          }
          td.center {
            width: 5em;
          }
          td.male {
            text-align: right;
            width: 50%;
          }
          td.female {
            text-align: left;
            width: 50%;
          }
          div {
            /*line-height: 1;*/
            vertical-align: bottom;
          }
          div.nin,
          td.center div {
            font-size: 6px;
            -webkit-transform: scale(0.5);
            -moz-transform: scale(0.5);
            -ms-transform: scale(0.5);
            -o-transform: scale(0.5);
            transform: scale(0.5);
            display: inline-block;
            margin: 0;
            padding: 0;
            vertical-align: bottom;
          }
          td.center div {
            text-align: center;
          }
          div.bar {
            height: 5px;
            display: inline-block;
            margin: 0;
            padding: 0;
          }
          div.left {
            background-color: #3333ff !important;
            margin: 0;
            margin-left: 4px;
            border-bottom: 1px solid #1e90ff;
          }
          div.right {
            background-color: #ff3366 !important;
            margin: 0;
            margin-right: 4px;
            border-bottom: 1px solid #ff69b4;
          }
          span#source {
            font-size: 11pt;
          }
          div#button {
            text-align: right;
          }
          div#cho {
            display: block;
            width: 1100px;
            vertical-align: top;
            margin-top: 1em;
            padding: 0.2em 0.5em 0.2em 0.5em;
            background-color: #fffff0;
          }
          div#cho_list {
            display: block;
            margin: 0.5em 0 0.5em 0;
            vertical-align: top;
            text-align: center;
            font-size: 11pt;
          }
          div.cho {
            display: inline-block;
            margin-left: 0;
            margin-top: 0.5em;
            vertical-align: top;
            text-align: left;
          }
          div.footer {
            text-align: center;
            width: 1100px;
            margin-left: auto;
            margin-right: auto;
            font-size: 11pt;
          }
          /*div#option        { position: absolute;
                              top:5px;
                              left:5px;
                              font-size:11pt;
                              max-width:20em;
                            }*/
          div#storage_alert {
            padding: 5px 5px 5px 5px;
            color: red;
            display: none;
          }
          fieldset {
            margin: 0;
            padding: 0 5px 5px 5px;
          }
          li {
            list-style-type: none;
            padding-left: 0;
            text-indent: -0.2em;
          }
          span.inline-block {
            display: inline-block;
          }
          div#basic_data {
            position: absolute;
            top:615px;
            left:1090px;
            width: 420px;
            font-size: 11pt;
            text-align: right;
            z-index: 1000;
          }
          #jinko_sosu {
            display: table;
            margin-left: auto;
            margin-right: 0;
            margin-bottom: 1em;
          }
          #jinko_sosu span.tr {
            display: table-row;
          }
          #jinko_sosu span.td {
            display: table-cell;
            line-height: 12pt;
            padding: 2px 2px 2px 2px;
          }
          div#select {
            text-align: right;
          }
          #nenrei_3kubun {
            display: table;
            position: relative;
            bottom: 0px;
            right: 0px;
            margin-left: auto;
          }
          #nenrei_3kubun span.tr {
            display: table-row;
          }
          #nenrei_3kubun span.td {
            display: table-cell;
            line-height: 12pt;
            padding: 0px 5px 0px 5px;
            text-align: right;
          }
          #nenrei_3kubun input {
            width: 2.5em;
            height: 1.2em;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 2px;
            font-size: 10pt;
            background-color: #f9f9f9;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
          }
          #nenrei_3kubun input:focus {
            border-color: #0066cc;
            background-color: #fff;
            outline: none;
            box-shadow: 0 0 3px rgba(0, 102, 204, 0.3);
            z-index: 10;
            transform: scale(1.1);
          }
          #nenrei_3kubun input:hover {
            border-color: #999;
            z-index: 10;
            transform: scale(1.1);
          }
          
          /* セル全体を一つのブロックとして扱う */
          #nenrei_3kubun .age-cell-container {
            position: relative;
            display: inline-block;
            white-space: nowrap;
          }
          
          #nenrei_3kubun .age-text {
            display: inline-block;
            margin: 0 1px;
          }
          
          /* スピンコントロールの隠し表示 - セル内絶対配置 */
          #nenrei_3kubun .age-input-container {
            position: absolute;
            display: inline-block;
            width: 2.5em;
            height: 1.2em;
            top: -3px;
            z-index: 1;
          }
          
          /* 開始年齢の位置 */
          #nenrei_3kubun .age-input-container:first-of-type {
            left: -0.6em;
          }
          
          /* 終了年齢の位置（〜の後） */
          #nenrei_3kubun .age-input-container:last-of-type {
            left: 2.0em; /* 空白 + 〜 の幅分 - 半文字分左に移動 */
          }
          
          #nenrei_3kubun .age-display {
            display: inline-block;
            width: 100%;
            height: 100%;
            text-align: center;
            padding: 2px;
            font-weight: 600;
            color: #1616179a;
            cursor: pointer;
            border: 1px solid transparent;
            border-radius: 3px;
            transition: all 0.3s ease;
            line-height: 1.2em;
          }
          
          #nenrei_3kubun .age-display:hover {
            background-color: #f0f0f0;
            border-color: #ccc;
          }
          
          #nenrei_3kubun .age-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            pointer-events: none;
            z-index: 5;
            transform: scale(0.8);
            transition: all 0.3s ease;
          }
          
          #nenrei_3kubun .age-input-container:hover .age-input {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1.1);
            z-index: 10;
          }
          
          #nenrei_3kubun .age-input-container:hover .age-display {
            opacity: 0;
            pointer-events: none;
          }
          #nenrei_3kubun span.right {
            text-align: right;
          }
          #sosu,
          #male,
          #female {
            text-align: right;
          }
          #red {
            font-weight: normal;
            font-size: 90%;
            color: red;
          }
          #screen_shot_button {
            margin-top: 0.5em;
          }
          #screen_shot_section {
            text-align: center;
          }
          img.img_screenshot {
            vertical-align: middle;
            width: 400px;
            height: auto;
            border: 2px #336699 solid;
          }
          input.chk_screenshot {
            margin-left: 0;
            margin-right: 1em;
          }

          /*jQueryのダイアログボックスのデザイン*/
          .ui-dialog {
            line-height: 1.5em;
          }
          .ui-dialog-titlebar {
            margin-bottom: 0.5em;
          }
          .ui-widget {
            font-size: 1.2em;
          }
          .ui-dialog-buttonset {
            line-height: 1em;
          }
          .ui-dialog .ui-dialog-buttonpane {
            padding: 0;
          }
          span#dialog {
            display: block;
            padding: 0.5em;
            text-indent: 1em;
          }
          .ui-widget-header {
            background: #2b80d5;
            color: white;
          }
          .ui-widget.ui-widget-content {
            border-color: #2b80d5;
          }
        }
        @media screen and (max-width: 479px) {
          div#cho_list {
            text-align: left;
          }
        }
        
        /* ローディングスピナーアニメーション */
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        
        /* ローディング表示のレスポンシブ対応 */
        @media (max-width: 1200px) {
          #loading-container {
            margin-left: 0 !important;
          }
        }
      </style>
    </head>
    <body onload="on_page_load()">
      <!--旧システムコード対応-->
      <input type="hidden" id="save" />
      <input type="hidden" id="clear" checked />

      <div id="main">
        <div id="header" data-html2canvas-ignore="true">
          <a
            href="#"
            class="header"
            data-tooltip="●横浜市全体の将来推計人口を2024年1月に公表された新たな将来推計人口に差し替えました。区別の将来推計人口は3月に公表される予定です。<br>●スクリーンショットの解像度を上げて文字が読めるようにしました。<br>●人口ピラミッドのスクリーンショットを撮り画像ファイルとして保存することができるようになりました。<br>●年齢3区分区別の人口と構成比を見ることができるようになりました。年齢区分はデフォルトでは通常の年少人口、生産年齢人口、高齢人口の区分で表示しますが、区切りの年齢を自由に変更して見ることができます。例えば、中位の年齢区分を「65〜75歳」とすれば、前期高齢者、後期高齢者の人数や構成比を確認することができます。<br>●将来推計人口を人口ピラミッドで見ることができるようになりました。また、市区の動画では横軸を固定し、人口の増減を合わせて見ることができるようになりました。"
          >
            ><span style="color: red; font-size: 100%">New!</span>
          </a>
          <a
            href="#"
            class="header"
            data-tooltip="横浜市がWebサイトで公表している人口統計を利用して作成可能な全ての人口ピラミッドを自由自在に表示できるサイトです。統計がある全ての年、区、町丁目、複数の町丁目を含む小地域の人口ピラミッドを表示させることができます。2017年12月に公表された2065年までの将来推計人口による将来予測も人口ピラミッドで表示。横浜市がHPで公表しているオープンデータをリアルタイムで取得するので、新しい統計が公表されたときタイムラグなしにすぐに人口ピラミッドで見ることができます。"
          >
            >このサイトについて
          </a>
          <a
            href="#"
            class="header"
            data-tooltip="このサイトでは、グラフの形から人口の年齢別構成を把握しやすくするため、人口の多い少ないにかかわらずグラフの面積が一定となるように描画することを基本としています。このため、人口の多寡をグラフの大きさから読み取ることはできません。ただし、例外として、市と区の人口ピラミッドの変化を動画で見るときに限っては、横軸の目盛を固定して描画しており、人口の増減を合わせてみることができるようにしています。"
          >
            >人口ピラミッドと人口の増減について
          </a>
          <a
            href="#"
            class="header"
            data-tooltip="PC、Mac、Androidスマホ、iPhone、iPadで動作を確認しています。ブラウザは、Google Chrome、Firefox、Safari、Microsoft Edgeで動作確認しています。インターネットエクスプローラーには対応していません。Windows PCの方は、Edge、Chrome、Firefoxなどでご覧ください"
          >
            >端末、ブラウザの対応状況について
          </a>
          <a
            href="#"
            class="header"
            data-tooltip="このサイトは午後10時から午前8時までの間はスリープ状態になります。その時間帯にこのサイトにアクセスすると、スリープから復帰するまでに10数秒お待ちいただくことになります。一度動き出せば普通に応答します。30分間アクセスがないと再びスリープ状態に移行します。運用経費を節約するためです。ご不便をおかけしますが、ご了承ください。"
            >>利用可能時間について</a
          >
        </div>

        <h1 id="h1" data-html2canvas-ignore="true">横浜市の人口ピラミッド</h1>
        
        <!-- データ読み込み中の表示 -->
        <div id="loading-container" style="text-align: center; padding: 60px 20px; color: #666; margin-left: 250px; max-width: 1108px;">
          <div style="font-size: 18px; margin-bottom: 20px;">
            <div style="display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px;"></div>
            データを読み込み中です...
          </div>
          <div style="font-size: 14px; color: #999;">
            人口統計データを取得しています。しばらくお待ちください。
          </div>
        </div>
        
        <h2 id="h2" style="display: none;">横浜市(平成28年1月1日現在)</h2>

        <div id="container-flex" style="display: none;">
          <div id="pyramid-block">
            <div id="link" data-html2canvas-ignore="true">
              <a href="#cho">地域別人口ピラミッドのための町丁名の指定</a>
              <a
                href="#"
                class="info-icon-right"
                data-tooltip="区のピラミッドを表示するとグラフの下部にその区内の町丁名のチェックボックスが表示されます。町丁名を指定して[町丁別人口ピラミッド]ボタンをクリックすると指定した地域のグラフを表示します。町丁名は複数の指定が可能で、複数の町丁からなる任意の地域の人口ピラミッドを表示することができます。"
                ><img src="./image/info-icon.png"
              /></a>
            </div>

            <!-- #市区、年月セレクトボックス -->
            <div id="select-controls">
              <div id="comment" data-html2canvas-ignore="true">
                データを取得中です.
              </div>
              <div id="hitoku" data-html2canvas-ignore="true">
                数字が著しく小さいために秘匿処理(統計表では"X"表記)されたデータがありました。ここでは便宜上"X"を0(ゼロ)として取り扱っています。
              </div>
              <div id="caption" data-html2canvas-ignore="true">
                <form name="Form" id="form0">
                  <select onChange="change_shiku()" name="shiku" id="shiku">
                    <option selected="selected" value="age">横浜市</option>
                    <option value="tsurumi">鶴見区</option>
                    <option value="kanagawa">神奈川区</option>
                    <option value="nishi">西区</option>
                    <option value="naka">中区</option>
                    <option value="minami">南区</option>
                    <option value="konan">港南区</option>
                    <option value="hodogaya">保土ケ谷区</option>
                    <option value="asahi">旭区</option>
                    <option value="isogo">磯子区</option>
                    <option value="kanazawa">金沢区</option>
                    <option value="kohoku">港北区</option>
                    <option value="midori">緑区</option>
                    <option value="aoba">青葉区</option>
                    <option value="tsuzuki">都筑区</option>
                    <option value="totsuka">戸塚区</option>
                    <option value="sakae">栄区</option>
                    <option value="izumi">泉区</option>
                    <option value="seya">瀬谷区</option>
                  </select>

                  <select
                    onChange="change_shiku_year()"
                    name="shiku_year"
                    id="shiku_year"
                  >
                    <option value="2065ft">2065年(将来推計)</option>
                    <option value="2064ft">2064年(将来推計)</option>
                    <option value="2063ft">2063年(将来推計)</option>
                    <option value="2062ft">2062年(将来推計)</option>
                    <option value="2061ft">2061年(将来推計)</option>
                    <option value="2060ft">2060年(将来推計)</option>
                    <option value="2059ft">2059年(将来推計)</option>
                    <option value="2058ft">2058年(将来推計)</option>
                    <option value="2057ft">2057年(将来推計)</option>
                    <option value="2056ft">2056年(将来推計)</option>
                    <option value="2055ft">2055年(将来推計)</option>
                    <option value="2054ft">2054年(将来推計)</option>
                    <option value="2053ft">2053年(将来推計)</option>
                    <option value="2052ft">2052年(将来推計)</option>
                    <option value="2051ft">2051年(将来推計)</option>
                    <option value="2050ft">2050年(将来推計)</option>
                    <option value="2049ft">2049年(将来推計)</option>
                    <option value="2048ft">2048年(将来推計)</option>
                    <option value="2047ft">2047年(将来推計)</option>
                    <option value="2046ft">2046年(将来推計)</option>
                    <option value="2045ft">2045年(将来推計)</option>
                    <option value="2044ft">2044年(将来推計)</option>
                    <option value="2043ft">2043年(将来推計)</option>
                    <option value="2042ft">2042年(将来推計)</option>
                    <option value="2041ft">2041年(将来推計)</option>
                    <option value="2040ft">2040年(将来推計)</option>
                    <option value="2039ft">2039年(将来推計)</option>
                    <option value="2038ft">2038年(将来推計)</option>
                    <option value="2037ft">2037年(将来推計)</option>
                    <option value="2036ft">2036年(将来推計)</option>
                    <option value="2035ft">2035年(将来推計)</option>
                    <option value="2034ft">2034年(将来推計)</option>
                    <option value="2033ft">2033年(将来推計)</option>
                    <option value="2032ft">2032年(将来推計)</option>
                    <option value="2031ft">2031年(将来推計)</option>
                    <option value="2030ft">2030年(将来推計)</option>
                    <option value="2029ft">2029年(将来推計)</option>
                    <option value="2028ft">2028年(将来推計)</option>
                    <option value="2027ft">2027年(将来推計)</option>
                    <option value="2026ft">2026年(将来推計)</option>
                    <option value="2025ft">2025年(将来推計)</option>
                    <option value="2024ft">2024年(将来推計)</option>
                    <option value="2023ft">2023年(将来推計)</option>
                    <option value="new" selected>　　 最新</option>
                    <option value="202101">令和3年1月1日現在</option>
                    <option value="202001">令和2年1月1日現在</option>
                    <option value="201901">平成31年1月1日現在</option>
                    <option value="201801">平成30年1月1日現在</option>
                    <option value="201701">平成29年1月1日現在</option>
                    <option value="201601">平成28年1月1日現在</option>
                    <option value="201501">平成27年1月1日現在</option>
                    <option value="201401">平成26年1月1日現在</option>
                    <option value="201301">平成25年1月1日現在</option>
                    <option value="201201">平成24年1月1日現在</option>
                    <option value="201101">平成23年1月1日現在</option>
                    <option value="201001">平成22年1月1日現在</option>
                    <option value="200901">平成21年1月1日現在</option>
                    <option value="200801">平成20年1月1日現在</option>
                    <option value="200701">平成19年1月1日現在</option>
                    <option value="200601">平成18年1月1日現在</option>
                    <option value="200501">平成17年1月1日現在</option>
                    <option value="200401">平成16年1月1日現在</option>
                    <option value="200301">平成15年1月1日現在</option>
                    <option value="200201">平成14年1月1日現在</option>
                    <option value="200101">平成13年1月1日現在</option>
                    <option value="200001">平成12年1月1日現在</option>
                    <option value="199901">平成11年1月1日現在</option>
                    <option value="199801">平成10年1月1日現在</option>
                    <option value="199701">平成9年1月1日現在</option>
                    <option value="199601">平成8年1月1日現在</option>
                    <option value="199501">平成7年1月1日現在</option>
                    <option value="199401">平成6年1月1日現在</option>
                    <option value="199301">平成5年1月1日現在</option>
                    <option value="199201">平成4年1月1日現在</option>
                    <option value="199101">平成3年1月1日現在</option>
                    <option value="199001">平成2年1月1日現在</option>
                    <option value="198901">昭和64年1月1日現在</option>
                    <option value="198801">昭和63年1月1日現在</option>
                    <option value="198701">昭和62年1月1日現在</option>
                    <option value="198601">昭和61年1月1日現在</option>
                    <option value="198501">昭和60年1月1日現在</option>
                    <option value="198401">昭和59年1月1日現在</option>
                    <option value="198301">昭和58年1月1日現在</option>
                    <option value="198201">昭和57年1月1日現在</option>
                    <option value="198101">昭和56年1月1日現在</option>
                    <option value="198001">昭和55年1月1日現在</option>
                    <option value="197901">昭和54年1月1日現在</option>
                    <option value="197801">昭和53年1月1日現在</option>
                    <option value="197701">昭和52年1月1日現在</option>
                    <option value="197601">昭和51年1月1日現在</option>
                    <option value="197510">昭和50年10月1日現在</option>
                    <option value="197010">昭和45年10月1日現在</option>
                    <option value="196510">昭和40年10月1日現在</option>
                    <option value="196010">昭和35年10月1日現在</option>
                    <option value="195510">昭和30年10月1日現在</option>
                    <option value="195010">昭和25年10月1日現在</option>
                    <option value="194710">昭和22年10月1日現在</option>
                    <option value="193510">昭和10年10月1日現在</option>
                    <option value="193010">昭和5年10月1日現在</option>
                    <option value="192510">大正14年10月1日現在</option>
                    <option value="192010">大正9年10月1日現在</option>
                  </select>

                  <select
                    onChange="change_cho_year()"
                    name="cho_year"
                    id="cho_year"
                  >
                    <option value="202109">令和３年9月30日現在</option>
                    <option value="202009">令和２年9月30日現在</option>
                    <option value="201909">平成31・令和元年9月30日現在</option>
                    <option value="201809">平成30年9月30日現在</option>
                    <option value="201709">平成29年9月30日現在</option>
                    <option value="201609">平成28年9月30日現在</option>
                    <option value="201509">平成27年9月30日現在</option>
                    <option value="201409">平成26年9月30日現在</option>
                    <option value="201309">平成25年9月30日現在</option>
                    <option value="201209">平成24年9月30日現在</option>
                    <option value="201109">平成23年9月30日現在</option>
                    <option value="201009">平成22年9月30日現在</option>
                    <option value="200909">平成21年9月30日現在</option>
                    <option value="200809">平成20年9月30日現在</option>
                    <option value="200709">平成19年9月30日現在</option>
                    <option value="200609">平成18年9月30日現在</option>
                    <option value="200509">平成17年9月30日現在</option>
                    <option value="200409">平成16年9月30日現在</option>
                    <option value="200309">平成15年9月30日現在</option>
                    <option value="200209">平成14年9月30日現在</option>
                    <option value="200109">平成13年9月30日現在</option>
                    <option value="200009">平成12年9月30日現在</option>
                    <option value="199909">平成11年9月30日現在</option>
                    <option value="199809">平成10年9月30日現在</option>
                  </select>

                  <button
                    onClick="ani_mation()"
                    name="animation"
                    type="button"
                    id="doga"
                  >
                    動画
                  </button>
                  <input id="unit_size" value="undefined" type="hidden" />
                  <a
                    href="#"
                    class="info-icon-right"
                    data-tooltip="動画をクリックすると一番古いものから最新のものまで、年を自動的に切り替えて移り変わりを動画のように表示します。"
                    ><img src="./image/info-icon.png"
                  /></a>
                </form>
              </div>
              <div class="control-group demo-controls">
                <label>デモデータ</label>
                <select id="demoData">
                  <option value="shi" selected>横浜市 2022年１月１日）</option>
                  <option value="aoba">青葉区 2022年１月１日</option>
                  <option value="nishi">西区 2022年１月１日</option>
                </select>
              </div>
            </div>
            <!-- #select-controls ここまで -->

            <!-- #SVG描画領域 -->
            <div id="pyramid-container"></div>
            <!-- #pyramid-container ここまで -->

            <!--年齢別人口の出典-->
            <div id="source_container">
              <span id="source" data-html2canvas-ignore="true">
                年齢別人口(<a
                  href="http://www.city.yokohama.lg.jp/ex/stat/jinko/age/new/tsurumi-j.html"
                  >http://www.city.yokohama.lg.jp/ex/stat/jinko/age/new/tsurumi-j.html</a
                >)
              </span>
            </div>
            <!-- #source_container ここまで -->

            <!-- 町丁別人口ピラミッドボタンと町丁名リスト -->
            <div id="cho" data-html2canvas-ignore="true">
              <a href="link"></a>
              <form name="chobetsu">
                <div id="button">
                  <input
                    type="button"
                    value="町丁別人口ピラミッド"
                    onClick="cho_pyramid_button()"
                  />
                  <input
                    type="button"
                    value="区全体の人口ピラミッド"
                    onClick="ku_pyramid_button()"
                  />
                  <input
                    type="button"
                    value="クリア"
                    onClick="checkbox_clear()"
                  />
                  <input type="hidden" value="shiku" id="mode" />
                  <a
                    href="#here"
                    class="info-icon-bottom"
                    data-tooltip="地域の人口ピラミッドを表示するには、町丁名をチェックしてから[町丁別人口ピラミッド]をクリックしてください。複数選択が可能です。"
                    ><img src="./image/info-icon.png"
                  /></a>
                </div>
                <div id="cho_list">
                  <!--ここに町丁名リストが入る-->
                </div>
              </form>
            </div>
            <!-- #cho ここまで -->
          </div>
          <!-- pyramid-block ここまで -->

          <!-- 左端に縦に並ぶコントロール -->
          <div class="left-controls">
            <div
              id="option"
              class="control-group"
              data-html2canvas-ignore="true"
            >
              <h3>スクリーンショット
                <a
                  href="#here"
                  class="header"
                  data-tooltip="テスト表示"
                  id="screen_shot_tooltip"
                  ><img src="./image/info-icon.png"
                /></a>
              </h3>
              <div class="button-group">
                <button onClick="screen_shot()" id="screen_shot_button">
                  スクリーンショット
                </button>
                <span id="dialog"></span>
              </div>
            </div>

            <div class="control-group">
              <h3>縦横サイズ変更</h3>
              <div class="button-group">
                <button id="uin">＋ 拡大</button>
                <button id="uout">－ 縮小</button>
              </div>
              <div class="radio-group">
                <label>
                  <input
                    type="radio"
                    name="unitType"
                    id="unitsize"
                    value="width"
                    checked
                  />
                  <span>横</span>
                </label>
                <label>
                  <input
                    type="radio"
                    name="unitType"
                    id="barheight"
                    value="height"
                  />
                  <span>縦</span>
                </label>
              </div>
            </div>

            <div class="control-group">
              <h3>ズーム</h3>
              <div class="button-group">
                <button id="zin">＋ 拡大</button>
                <button id="zout">－ 縮小</button>
              </div>
              <label>倍率: <span id="scaleLabel">100%</span></label>
            </div>

            <div class="control-group">
              <h3>オプション</h3>
              <div class="button-group">
                <button onclick="toggleNumbers()">人数表示切替</button>
                <button onclick="toggleGrid()">グリッド切替</button>
                <button onclick="toggleAgeGroup()" id="age_group_toggle">年齢３区分を非表示</button>
              </div>
            </div>
          </div>
          <!-- #left-controls ここまで -->

          <!-- 基本データ(人口と3区分別人口) -->
          <div id="basic_data">
            <div id="jinko_sosu">
              <span class="tr">
                <span class="td"></span>
                <span class="td">人口</span>
                <span class="td" id="sosu">xxx,xxx人</span>
                <span class="td"></span>
              </span>
              <span class="tr">
                <span class="td"></span>
                <span class="td">男</span>
                <span class="td" id="male">xxx,xxx人</span>
                <span class="td"></span>
              </span>
              <span class="tr">
                <span class="td"></span>
                <span class="td">女</span>
                <span class="td" id="female">xxx,xxx人</span>
                <span class="td"></span>
              </span>
            </div>
            <!--jinko_sosu ここまで-->
            <div id="select" data-html2canvas-ignore="true">
              <select
                id="kubun_unit"
                onchange="kubunDisplay()"
                style="width: 11em"
              >
                <option value="構成比" selected="selected">
                  年齢3区分別構成比
                </option>
                <option value="人口">年齢3区分別人口</option>
                <option value="非表示">年齢3区分別人口/構成比非表示</option>
              </select>
              <a
                href="#"
                id="info_3kubun"
                class="info-icon-3kubun"
                data-tooltip="年齢3区分の中位の年齢を自由に変更することができます。例えば、中位の年齢区分を「65〜75歳」とすれば、前期高齢者、後期高齢者の人数や構成比を見ることができます。<br>ピラミッドと重なってしまうときは非表示にしてください。"
                ><img src="./image/info-icon.png"
              /></a>
              <input
                id="kubun_button"
                type="submit"
                value="3区分表示"
                onclick="kubunSelectDisp()"
              />
              <input id="kubun_selected" type="hidden" value="" />
            </div>
            <div id="nenrei_3kubun">
              <span class="tr">
                <span class="td">年 齢 区 分</span>
                <span class="td">総数</span>
                <span class="td">男</span>
                <span class="td">女</span>
              </span>
              <span class="tr">
                <span class="td">
                  <span id="heigher">75</span>
                  歳以上
                </span>
                <span class="td" id="ku3_sosu">xxx,xxx人</span>
                <span class="td" id="ku3_male">xxx,xxx人</span>
                <span class="td" id="ku3_female">xxx,xxx人</span>
              </span>
              <span class="tr">
                <span class="td" id="kubun2_title">
                  <div class="age-cell-container">
                    <span class="age-text">　</span>
                    <div class="age-input-container">
                      <span class="age-display" id="startAgeDisplay">15</span>
                      <input
                        type="number"
                        id="smiddle"
                        class="age-input"
                        value="15"
                        min="0"
                        max="99"
                        onchange="kubunChange(); updateAgeDisplay('start', this.value)"
                        oninput="validateAgeInput(this); updateAgeDisplay('start', this.value)"
                        title="開始年齢（0-99歳）"
                      />
                    </div>
                    <span class="age-text">〜</span>
                    <span class="age-text">　</span>
                    <div class="age-input-container">
                      <span class="age-display" id="endAgeDisplay">64</span>
                      <input
                        type="number"
                        id="emiddle"
                        class="age-input"
                        value="64"
                        min="0"
                        max="99"
                        onchange="kubunChange(); updateAgeDisplay('end', this.value)"
                        oninput="validateAgeInput(this); updateAgeDisplay('end', this.value)"
                        title="終了年齢（0-99歳）"
                      />
                    </div>
                    <span class="age-text">歳</span>
                  </div>
                </span>
                <span class="td" id="ku2_sosu">xx,xxx人</span>
                <span class="td" id="ku2_male">xx,xxx人</span>
                <span class="td" id="ku2_female">xx,xxx人</span>
              </span>
              <span class="tr">
                <span class="td">
                  0〜
                  <span id="lower">14</span>
                  歳
                </span>
                <span class="td" id="ku1_sosu">xx,xxx人</span>
                <span class="td" id="ku1_male">xx,xxx人</span>
                <span class="td" id="ku1_female">xx,xxx人</span>
              </span>
            </div>
            <!--#nenrei_3kuibun ここまで-->
          </div>
          <!--#basic_data ここまで-->

        </div>
        <!-- #container-flex ここまで -->
      </div>
      <!-- id=main ここまで -->

      <!-- スクリーンショット描画領域 -->
      <div id="screen_shot_section"></div>
      <!-- #screen_shot_section ここまで -->

      <!-- フッタ部分 -->
      <div class="footer" id="footer" data-html2canvas-ignore="true" style="display: none;">
        <hr class="margin-top margin-bottom" />
        <!-- ここから著作権情報と連絡先 -->
        <address>
          <span style="display: block">
            <span class="block"> INUZUKA Katsu </span
            ><span> - 2016年12月21日 作成 </span
            ><span> - 2024年2月29日 更新 </span>
          </span>
          <span style="display: block">
            <span class="block">
              問い合わせ、連絡先（不具合の報告、改良のアイディアをお寄せください.） </span
            ><span class="block">
              -
              <a href="mailto:inuzuka0601&#64;gmail.com"
                >inuzuka0601&#64;gmail.com</a
              >
            </span>
          </span>
          <span> &copy;2016-2024 INUZUKA Katsu. </span>
          <span> All rights reserved. </span>
        </address>
        <!-- ここまで著作権情報と連絡先 -->
      </div>
      <!-- ここまでフッタ部分 -->

      <script>
        let currentRenderer = null;
        let isSVGMode = true;
        let currentOptions = {
          showNumbers: true,
          showGrid: true,
        };


        // 初期化
        document.addEventListener("DOMContentLoaded", function () {
          // セレクトボックスのイベントリスナーを設定
          //const demoDataSelect = document.getElementById("demoData");
          //demoDataSelect.addEventListener("change", changeDemoData);
          // 初期データの読み込み
          //loadDemoData();
          // バーの高さスライダーのイベントリスナーを設定
          //const barHeightSlider = document.getElementById('barHeightSlider');
          //barHeightSlider.addEventListener('input', updateBarHeightValue);
        });

        // ユニットサイズの変更
        const uin = document.getElementById("uin");
        const uout = document.getElementById("uout");
        const radio = document.getElementById("unitsize");
        uin.addEventListener("click", () => {
          if (radio.checked) {
            let unitSize = currentRenderer.options.unitSize * 1.01;
            currentRenderer.resize({ unitSize: unitSize });
          } else {
            let barHeight = currentRenderer.options.barHeight * 1.01;
            currentRenderer.resize({ barHeight: barHeight });
          }
        });
        uout.addEventListener("click", () => {
          if (radio.checked) {
            let unitSize = currentRenderer.options.unitSize * 0.99;
            currentRenderer.resize({ unitSize: unitSize });
          } else {
            let barHeight = currentRenderer.options.barHeight * 0.99;
            currentRenderer.resize({ barHeight: barHeight });
          }
        });

        // ズームによるピラミッドサイズの変更
        const zin = document.getElementById("zin");
        const zout = document.getElementById("zout");
        const zoom = document.getElementById("scaleLabel");
        let scale = 1;
        zin.addEventListener("click", () => {
          scale = Math.min(1.5, scale + 0.01);
          zoom.value = scale;
          currentRenderer.resize({ scale: scale });
          zoom.textContent = (scale * 100).toFixed(0) + "%";
        });
        zout.addEventListener("click", () => {
          scale = Math.max(0.25, scale - 0.01);
          zoom.value = scale;
          currentRenderer.resize({ scale: scale });
          zoom.textContent = (scale * 100).toFixed(0) + "%";
        });

        function changePyramidSize() {
          const scale = parseFloat(
            document.getElementById("pyramidSize").value
          );
          if (currentRenderer) {
            currentRenderer.resize({ scale: scale });
          }
        }

        // 人数表示の切り替え
        function toggleNumbers() {
          currentOptions.showNumbers = !currentOptions.showNumbers;
          if (currentRenderer) {
            currentRenderer.updateOptions({
              showNumbers: currentOptions.showNumbers,
            });
          }
        }

        // グリッド表示の切り替え
        function toggleGrid() {
          currentOptions.showGrid = !currentOptions.showGrid;
          if (currentRenderer) {
            currentRenderer.updateOptions({
              showGrid: currentOptions.showGrid,
            });
          }
        }

        // 年齢3区分表示の切り替え
        function toggleAgeGroup() {
          const basicData = document.getElementById("basic_data");
          const toggleButton = document.getElementById("age_group_toggle");
          
          if (basicData.style.display === "none") {
            // 非表示の場合は表示に
            basicData.style.display = "block";
            toggleButton.textContent = "年齢３区分を非表示";
          } else {
            // 表示の場合は非表示に
            basicData.style.display = "none";
            toggleButton.textContent = "年齢３区分を表示";
          }
        }

        // ハイブリッドリサイズの適用
        function applyHybridResize() {
          if (!currentRenderer) return;

          const barHeight = parseFloat(
            document.getElementById("barHeightSlider").value
          );
          const newHeight = Math.floor(101 * barHeight + 100); // 101年齢 × barHeight + 100pxマージン

          currentRenderer.resize({ barHeight: barHeight, height: newHeight });
        }

        // データの読み込み
        function loadDemoData() {
          console.log("loadDemoData 関数定義完了");
          const selectedData = document.getElementById("demoData").value;
          const dataScript = document.getElementById(selectedData + "-data");
          console.log("rout1");

          if (!dataScript) {
            console.error("データが見つかりません:", selectedData);
            return;
          }
          console.log("rout2");
          try {
            console.log("dataScript", dataScript.textContent);
            const data = JSON.parse(dataScript.textContent);
            console.log("data", data["kakusai_betsu"][0]);
            renderPyramid(data);
          } catch (error) {
            console.error("データの解析に失敗しました:", error);
          }
        }

        // データの切り替え　共通描画部分は変更ないのでupdateDataメソッドを使用
        function changeDemoData() {
          console.log("changeDemoData 関数定義完了");
          const selectedData = document.getElementById("demoData").value;
          const dataScript = document.getElementById(selectedData + "-data");
          const data = JSON.parse(dataScript.textContent);
          currentRenderer.updateData(data);
          
          // データ更新後に#basic_dataの位置を再計算
          setTimeout(() => {
            centerContents();
          }, 100);
        }

        // ピラミッドの描画
        function renderPyramid(data) {
          console.log("renderPyramid 関数定義完了");
          if (!isSVGMode) {
            document.getElementById("pyramid-container").innerHTML =
              '<p style="text-align: center; padding: 50px;">このデモではSVG描画のみ対応しています</p>';
            return;
          }
          console.log("rout3");
          //const options = {
          //    ...currentOptions,
          //    scaleMode: document.getElementById('scaleMode').value
          //};
          console.log("rout4");
          try {
            currentRenderer = new PyramidSVGRenderer("pyramid-container", data);
            //document.getElementById('status').textContent =
            //    `SVG描画エンジンが有効です - ${data.shiku} (${data.kijunbi})`;
            
            // SVG描画完了後に表示を切り替え
            setTimeout(() => {
              // ローディング表示を非表示に
              document.getElementById("loading-container").style.display = "none";
              
              // メインコンテンツを表示
              document.getElementById("h2").style.display = "block";
              document.getElementById("container-flex").style.display = "flex";
              document.getElementById("footer").style.display = "block";
              
              // #basic_dataの位置を再計算
              centerContents();
            }, 100);
          } catch (error) {
            console.error("描画に失敗しました:", error);
            document.getElementById("pyramid-container").innerHTML =
              '<p style="text-align: center; padding: 50px; color: red;">描画エラーが発生しました</p>';
          }
        }
        // 定義完了後の確認
        console.log("スクリプト読み込み完了時:");
        console.log("loadDemoData:", typeof loadDemoData);
        console.log("renderPyramid:", typeof renderPyramid);

        // 画面デザイン（各要素の配置位置）
        function centerContents() {
          const menu = document.querySelector(".left-controls");
          const pyramid = document.querySelector("#pyramid-block");
          const footer = document.querySelector("#footer");
          const basic = document.querySelector("#basic_data");
          const pyramidContainer = document.querySelector("#pyramid-container");

          const pyramidContainer_rect = pyramidContainer.getBoundingClientRect();
          const menuWidth = menu.offsetWidth;
          const pyramidWidth = pyramid.offsetWidth;
          const windowWidth = window.innerWidth;
          const basicWidth = basic.offsetWidth;

          // 画面中央に配置（ウィンドウ中央 - (メニュー幅 + ピラミッド幅)の半分）
          const menuLeftPos = Math.max(
            0,
            (windowWidth - (menuWidth + pyramidWidth)) / 2 - 10
          );
          const pyramidLeftPos = Math.max(0, menuLeftPos + menuWidth);

          if (windowWidth >= 1200) {
            menu.style.left = menuLeftPos + "px";
            pyramid.style.left = pyramidLeftPos + "px";
            footer.style["margin-left"] = pyramidLeftPos - 10 + "px";
            
            // #basic_dataをSVG描画領域内の右下に配置
            const basicLeftPos = pyramidContainer_rect.right - basicWidth - 20;
            const basicTopPos = pyramidContainer_rect.bottom - basic.offsetHeight - 15;
            basic.style.left = basicLeftPos + "px";
            basic.style.top = basicTopPos + "px";
            basic.style.display = "block";
          } else if (windowWidth < 1200) {
            menu.style.left = "0px";
            pyramid.style.left = "0px";
            footer.style["margin-left"] = "0px";
            
            // SVG領域の固定幅（1108px）より画面幅が大きい場合は#basic_dataを表示
            const svgFixedWidth = 1108;
            if (windowWidth > svgFixedWidth) {
              // #basic_dataをSVG描画領域内の右下に配置
              const basicLeftPos = pyramidContainer_rect.right - basicWidth - 20;
              const basicTopPos = pyramidContainer_rect.bottom - basic.offsetHeight - 15;
              basic.style.left = basicLeftPos + "px";
              basic.style.top = basicTopPos + "px";
              basic.style.display = "block";
            } else {
              // SVG領域の固定幅より画面幅が小さい場合は非表示
              basic.style.display = "none";
            }
          }
        }

        // 初回実行
        centerContents();

        // ウィンドウリサイズ時に再度計算して反映
        window.addEventListener("resize", centerContents);

      </script>
    </body>
  </html>
</html>
